cmake_minimum_required(VERSION 3.10)
project("ComputationalGeometry")
set(CMAKE_CXX_STANDARD 20)

find_package(CGAL)

# macro to link CGAL
macro(link_cgal)
  set(_all_source ${ARGN})
  message(STATUS "COMPUTATIONAL GEOMETRY: build directory: ${CMAKE_CURRENT_SOURCE_DIR}")
  foreach(_source ${_all_source})
    set(_target_name ${_source})
    string(REPLACE "./" "" _target_name ${_target_name})
    string(REPLACE ".cpp" "" _target_name ${_target_name})
    message(STATUS "COMPUTATIONAL GEOMETRY: build target: ${_target_name}")
    add_executable(${_target_name} ${_source})
    target_link_libraries(${_target_name} CGAL)
  endforeach()
endmacro(link_cgal)

# add all subdirectories
file(GLOB _all_files RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/*)
foreach(_file ${_all_files})
  if (IS_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/${_file})
    if(${_file} MATCHES "CH*")
      message(STATUS "COMPUTATIONAL GEOMETRY: add subdirectory: ${_file}")
      add_subdirectory("${_file}")
    endif()
  endif()
endforeach()
